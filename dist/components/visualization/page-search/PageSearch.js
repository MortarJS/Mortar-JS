"use strict";var _=require("lodash"),React=require("react/addons"),Input=require("../../resource-editing/resource-form/Input"),PageSearch=React.createClass({displayName:"PageSearch",propTypes:{searchable:React.PropTypes.array.isRequired,minLength:React.PropTypes.number,options:React.PropTypes.shape({queryTimeout:React.PropTypes.number})},getInitialState:function(){return{search:{query:""}}},currentTimeout:0,_buildFilterObject:function e(t,r,a,s){if(!t)return{};s=s||!1;var e=this._buildFilterObject;return r.forEach(function(r,i){s||0!==i?a.hasOwnProperty("or")?e(t,[r],a.or,!0):(a.or={},a.or[r]="~"+t):a[r]="~"+t}),a},_handleSearchChange:function(e,t,r){var a=this.props.options||{};clearTimeout(this.currentTimeout),delete this.currentTimeout;var s=this.queryData;this.currentTimeout=setTimeout(function(){s()},a.queryTimeout||500),this.setState({search:{query:t}})},queryData:function(){var e={},t=this.state.search.query;this.props.minLength||1;t.length<this.props.minLength||(e=this._buildFilterObject(t,this.props.searchable,{})),this.props.actionMethod({filters:e})},render:function(){return React.createElement("div",{className:"input-group custom-search-form"},React.createElement(Input,{fieldKey:"query",bindResource:this.state.search,changeCallback:this._handleSearchChange,placeholder:"Search..",type:"text"}),React.createElement("span",{className:"input-group-btn"},React.createElement("button",{className:"btn btn-default",type:"button",onClick:this.queryData},React.createElement("i",{className:"icon-search"}))))}});module.exports=PageSearch;