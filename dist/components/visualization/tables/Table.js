"use strict";var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol?"symbol":typeof t},Rows=require("./Rows"),React=require("react/addons"),Modal=require("../../global/modal/ModalContainer"),Spinner=require("../../global/spinner/Spinner"),SortButton=require("./SortButton"),Table=React.createClass({displayName:"Table",propTypes:{data:React.PropTypes.array.isRequired,dataKeys:React.PropTypes.object.isRequired,options:React.PropTypes.shape({actionableRows:React.PropTypes.bool,draggable:React.PropTypes.bool,actionsCallback:React.PropTypes.func,bulkActions:React.PropTypes.bool,summableRows:React.PropTypes.array}).isRequired,actionCreator:React.PropTypes.object},getDefaultProps:function(){return{data:[]}},getInitialState:function(){return{showTooltip:!1,selected:!1,tooltipKey:null}},componentDidMount:function(){},columns:0,buildTableColumns:function(){var t=Object.keys(this.props.dataKeys).map(function(t,e){return React.createElement("th",{key:e},t," ",this._shouldRenderInfoIcon(t,this.props.dataKeys[t]))}.bind(this));if(this.props.options&&this.props.options.actionableRows&&t.push(React.createElement("th",{key:99},"Actions")),this.props.options&&"object"===_typeof(this.props.options.mainAction)&&t.unshift(React.createElement("th",{key:100})),this.props.options&&this.props.options.bulkActions){var e=this.state.selected;t.unshift(React.createElement("th",{key:101},React.createElement("input",{type:"checkbox",value:e,onChange:this.toggleAllCheckboxes})))}return this.columns=t.length,React.createElement("thead",null,React.createElement("tr",null,t))},toggleAllCheckboxes:function(t){var e=!this.state.selected;this.setState({selected:e}),this.props.data.forEach(function(t){t.selected=e}.bind(this)),this.props.options.actionsCallback("selectAllRows",this.props.data)},toggleTooltip:function(t){t.preventDefault(),this.setState({showTooltip:!this.state.showTooltip,tooltipKey:t.target.dataset.key})},closeModal:function(){this.setState({showTooltip:!1,tooltipKey:null})},_shouldRenderInfoIcon:function(t,e){var o=this.props.options||{},a=[];return"object"===_typeof(o.tooltips)&&o.tooltips.hasOwnProperty(t)&&a.push(React.createElement("button",{key:t,className:"icon-info-circle pull-right",type:"button",onClick:this.toggleTooltip,"data-key":t})),"[object Array]"===Object.prototype.toString.call(o.sortable)&&o.sortable.indexOf(e)>-1&&a.push(React.createElement(SortButton,{key:o.sortable.indexOf(e),actionsCallback:o.actionsCallback,sortProperty:e})),a},_shouldLoadSpinner:function(){var t=this.props.options||{};return t.hideSpinner?t.hideSpinner?React.createElement("tbody",null,React.createElement("tr",null,React.createElement("td",{colSpan:this.columns,className:"table-empty-row"},t.emptyText||"No results :(."))):void 0:React.createElement("tbody",null,React.createElement("tr",null,React.createElement("td",{colSpan:this.columns},React.createElement(Spinner,{type:"spinner",text:"Loading..",classes:"table-loader"}))))},render:function(){return React.createElement("div",{className:"table-modal-container"},React.createElement("table",{className:"table-data table table-bordered table-hover table-striped"},this.buildTableColumns(),this.props.data.length<1&&this._shouldLoadSpinner(),this.props.data.length>=1&&React.createElement(Rows,{data:this.props.data,dataKeys:this.props.dataKeys,options:this.props.options,actionCreator:this.props.actionCreator})),this.state.showTooltip&&React.createElement(Modal,{openWhen:this.state.showTooltip,options:{width:"40%"},afterClose:this.closeModal,afterSave:this.closeModal,title:this.state.tooltipKey,closeText:"Close",saveText:"OK"},React.createElement("p",null,this.props.options.tooltips[this.state.tooltipKey])))}});module.exports=Table;