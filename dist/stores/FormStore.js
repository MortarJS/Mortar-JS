"use strict";var _extends=Object.assign||function(e){for(var r=1;r<arguments.length;r++){var o=arguments[r];for(var t in o)Object.prototype.hasOwnProperty.call(o,t)&&(e[t]=o[t])}return e},_=require("lodash"),AppActionConstants=require("../constants/AppActionConstants"),ActionTypes=AppActionConstants.ActionTypes.cms.form,AppDispatcher=require("../dispatcher/AppDispatcher"),BaseStore=require("./BaseStore"),_formStore={},_currentFormKey="",_typeaheadQueryData={},FormStore=_extends({},BaseStore,{getField:function(e,r){return _formStore[e]?_.get(_formStore[e].resource,r):null},hasForm:function(e){return _formStore.hasOwnProperty(e)},getResource:function(e){if(!e||""===e||"undefined"===e)throw new Error("Form key cannot be undefined");return _formStore[e]?_.cloneDeep(_formStore[e].resource):{}},getCurrentFormKey:function(){return _currentFormKey},isFormValid:function(e){return _formStore[e].isValid},isFieldValid:function(e,r){if(!_formStore[e])return!0;var o=_formStore[e].validations[r];return"undefined"==typeof o||o},getTypeaheadQueryData:function(e){return _typeaheadQueryData[e]},_setField:function(e,r,o){return _.set(e,r,o)},_validateForm:function(e){var r=!0,o=_formStore[e].validations;Object.keys(o).forEach(function(e){o[e]||(r=!1)}),_formStore[e].isValid=r}});FormStore.dispatchToken=AppDispatcher.register(function(e){switch(e.type){case ActionTypes.FORM_REGISTER_FORM:_formStore[e.formKey]={},_formStore[e.formKey].validations=_formStore[e.formKey].validations||e.validations||{},_formStore[e.formKey].resource=_.cloneDeep(e.resource),_formStore[e.formKey].isValid="boolean"!=typeof e.isValid||e.isValid,_currentFormKey=e.formKey,FormStore.emitChange();break;case ActionTypes.FORM_EDIT_FIELD:_formStore[e.formKey].resource=FormStore._setField(_formStore[e.formKey].resource,e.fieldKey,e.value),_formStore[e.formKey].validations[e.fieldKey]=e.isValid,FormStore._validateForm(e.formKey),FormStore.emitChange();break;case ActionTypes.TYPEAHEAD_QUERY:_typeaheadQueryData[e.eventData.formKey]=e.data,FormStore.emitChange();break;case ActionTypes.FORM_CLEAR_TYPEAHEAD_QUERY:_typeaheadQueryData[e.formKey]=[];break;case ActionTypes.CLEAR_FORM:delete _formStore[e.formKey],FormStore.emitChange()}}),module.exports=FormStore;